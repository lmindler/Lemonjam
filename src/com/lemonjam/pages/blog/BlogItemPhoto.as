package com.lemonjam.pages.blog{	import flash.display.MovieClip;	import flash.events.Event;	import com.lemonjam.core.ImageLoader;	import com.greensock.*;	import flash.text.TextField;	import flash.text.TextFieldAutoSize;	import flash.text.TextFormatAlign;;	import com.lemonjam.util.HTMLTextUtil;	import com.lemonjam.ui.buttons.SecondaryButton;		public class BlogItemPhoto extends BlogItemBase	{		private var _img:ImageLoader;		private var _loaded:Boolean = false;		private var _origHeight:Number = 0;		private var _origWidth:Number = 0;		private var _desc:TextField;				private var _converter:HTMLTextUtil = new HTMLTextUtil();		private var _viewButton:SecondaryButton;						public function BlogItemPhoto(aData:Object, index:Number, totalLength:Number, stageHeight:Number)		{			_viewButton = getChildByName("buttonMC") as SecondaryButton;			_viewButton.setButton("VIEW POST", aData.url, true);						var tempDesc:String = _converter.convertText(aData.desc);						data = aData;												_desc = getChildByName("bodyTXT") as TextField;			_desc.autoSize = TextFormatAlign.LEFT;						_desc.height = 80;						_desc.alpha = 0;			_isTXT.text = index.toString();			_ofTXT.text = totalLength.toString();			_bg.height = stageHeight - 201;			type = "photo";						var alt:String = "...";									var tempWidth:Number = aData.width;			var tempHeight:Number = aData.height;			var percent:Number = 0;						if(tempHeight > tempWidth){				tempHeight = (_bg.height - 150);				percent = ((tempHeight*100) / aData.height);				tempWidth = Math.round((aData.width * percent)/100);								_desc.y = 100;				_desc.x = tempWidth + 70;				_desc.width = 200;				_desc.height = tempHeight;				_desc.text = tempDesc;				_desc.text = tempDesc;								_bg.width = _hitbox.width = (tempWidth + 300);							}						else {				if(tempHeight > (_bg.height-250)){					tempHeight = (_bg.height - 250);					percent = ((tempHeight*100) / aData.height);					tempWidth = Math.round((aData.width * percent)/100);				}								trace("temp width: " + aData.width);				trace("temp width: " + aData.height);				_desc.y = tempHeight + 20;				_desc.width = tempWidth;				_desc.text = tempDesc;				_bg.width = _hitbox.width = tempWidth + 120;												var char:int = _desc.getLineOffset(2) - 1;				char -= alt.length;				char = _desc.text.substring(0, char + 1).search(/\S\s*$/);				_desc.text = _desc.text.substring(0, char) + alt;											}						_viewButton.alpha = 0;			_viewButton.x = _desc.x;			_viewButton.y = _desc.y + _desc.height + 14;		}						public function loadContent():void		{			_img = new ImageLoader(data.photo);			_img.y = 105;			_img.x = 50;			_img.alpha = 0;			_img.addEventListener(Event.COMPLETE, _loadComplete);			this.addChild(_img);		}				private function _loadComplete(e:Event):void		{			_origHeight = _img.height;			_img.height = (_origHeight > (_bg.height-155)) ? (_bg.height - 155) : _origHeight;			_img.scaleX = _img.scaleY;									TweenLite.to(_img, .3, {alpha:1, delay:.3});			TweenLite.to(_desc, .3, {alpha:1, delay:.3});			TweenLite.to(_viewButton, .3, {alpha:1, delay:.3});						loaded = true;						dispatchEvent(new Event(Event.COMPLETE, true));		}				public function resize():void		{			if(loaded){				_img.height = (_origHeight > (_bg.height-155)) ? (_bg.height - 155) : _origHeight;				_img.scaleX = _img.scaleY;								itemWidth = _img.width;			}		}	}	}