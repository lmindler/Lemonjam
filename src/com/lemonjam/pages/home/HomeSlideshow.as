package com.lemonjam.pages.home{	import flash.events.ProgressEvent;	import flash.events.Event;		import com.greensock.*;	import com.lemonjam.ui.slide.BackgroundSlide;	import com.lemonjam.ui.slideshow.SlideshowBase;	import com.lemonjam.events.SlideshowEvent;	import com.asual.swfaddress.*;	import flash.utils.Timer;	import flash.events.TimerEvent;		public class HomeSlideshow extends SlideshowBase	{		private var _currentPhotoNum:Number = 0;		private var _timer:Timer = new Timer(5000, 1);		private var _waitToStartTimer:Boolean = false;				public function HomeSlideshow()		{			_timer.addEventListener(TimerEvent.TIMER, _timerTick);		}				public function build():void		{			if(_images[_currentPhotoNum].loaded){								for(var i=0;i<_images.length;i++){					if(_currentPhotoNum == i){						this.setChildIndex(_images[i], this.numChildren-1);						if(i == 0)		_images[i].build(true);						else			_images[i].build();						TweenLite.to(_images[i], 1, {alpha:1});					}					else{						_images[i].unbuild();						if(_images[i].alpha == 1)	TweenLite.to(_images[i], 0,{alpha:0, delay:1});					}				}				_timer.start();			}			else{				_timer.reset();				_timer.stop();							if(_currentPhotoNum == 0)		_images[_currentPhotoNum].build(true);				else							_images[_currentPhotoNum].build();				_waitToStartTimer = true;			}		}				public function unbuild():void		{			_timer.reset();			_timer.stop();		}				private function _timerTick(e:TimerEvent):void		{			_currentPhotoNum++;			if(_currentPhotoNum == _images.length)	_currentPhotoNum = 0;			build();						_timer.reset();			_timer.stop();			_timer.start();		}				private function _loadComplete(e:SlideshowEvent):void		{			resize();			if(_waitToStartTimer){				_waitToStartTimer = false;				_timer.reset();				_timer.start();				build();			}		}				public function dataLoaded(value:Array):void		{			data = value;						for(var i=0;i<data.length;i++){				var _img = new BackgroundSlide(data[i].img, data[i].forceHorizontal);				this.addChild(_img);				_images.push(_img);				_img.addEventListener(SlideshowEvent.SLIDE_LOAD_COMPLETE, _loadComplete);				//_img.addEventListener(Event.COMPLETE, _loadComplete);			}		}	}}