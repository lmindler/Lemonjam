package com.lemonjam.ui.preloader{	import flash.display.MovieClip;	import flash.text.TextField;	import flash.text.TextFieldAutoSize;	import flash.text.TextFormatAlign;	import flash.display.Stage;		import com.lemonjam.ui.PatternOverlay;	import com.lemonjam.ui.preloader.PreloaderBase;	import com.greensock.*;	import com.greensock.easing.*;	import flash.events.ProgressEvent;	import flash.events.Event;		public class Preloader extends PreloaderBase{		private var _percent:TextField;		private var _overlay:PatternOverlay;				private var _showing:Boolean = true;		private var _firstLoad:Boolean = true;				public function Preloader(){			_percent = getChildByName("percentTXT") as TextField;			_overlay = new PatternOverlay(1, 0x444444);						if(_firstLoad)		this.addChildAt(_overlay, 0);						this.mouseEnabled = this.mouseChildren = true;			_percent.selectable = _percent.mouseEnabled = false;			_percent.autoSize = TextFieldAutoSize.LEFT;			_percent.autoSize = TextFormatAlign.LEFT;					}				public function updateProgress(aBytesLoaded:Number, aBytesTotal:Number):void		{			updatePercent(Math.round((aBytesLoaded/aBytesTotal)*100));		}				public function updatePercent(value:Number):void{			this.mouseEnabled = this.mouseChildren = true;			_showing = true;			_percent.text = (value < 10) ? ("0" + value.toString() + "%") : (value.toString() + "%");			_percent.alpha = 1;						_percent.x = (stageW/2) - (_percent.width/2);			_percent.y = (stageH/2) - (_percent.height/2);		}				public function unbuild():void		{			_showing = false;			this.mouseEnabled = this.mouseChildren = false;			TweenLite.to(_percent, .4, {y:(stageH/2), alpha:0, ease:Quint.easeIn});			if(_firstLoad)		TweenLite.to(_overlay, 1, {alpha:0,  delay:.3, ease:Quint.easeOut});			if(_firstLoad)		dispatchEvent(new Event(Event.COMPLETE));			_firstLoad = false;		}				public function resize():void		{			stageW = stage.stageWidth;			stageH = (_firstLoad) ? stage.stageHeight : stage.stageHeight-65;						if(_firstLoad)		_overlay.resize(stageW, stageH);						_percent.x = (stageW/2) - (_percent.width/2);			_percent.y = (stageH/2) - (_percent.height/2);					}	}}